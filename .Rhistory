par(mfrow=c(2,2), oma=c(0,0,2,0))
hist(t2.mean, prob=T, main='표본크기: 2', ylab='', xlab='',
col='orange', border='red')
lines(x3, y3, lty=2, lwd=2, col='blue')
m = 0
s = sqrt(5 / (df-2))
c(m, s)
par(mfrow=c(2,2), oma=c(0,0,2,0))
hist(t2.mean, prob=T, main='표본크기: 2', ylab='', xlab='',
col='orange', border='red')
par(mfrow=c(2,2), oma=c(0,0,2,0))
hist(t2.mean, prob=T, main='표본크기: 2', ylab='', xlab='',
col='orange', border='red')
x1 = seq(min(t2.mean), max(t2.mean), length=1000)
y1 = dnorm(x1, m, s/sqrt(2))
lines(x1, y1, lty=2, lwd=2, col='blue')
hist(t4.mean, prob=T, main='표본크기: 4', ylab='', xlab='',
col='orange', border='red')
x2 = seq(min(t4.mean), max(t4.mean), length=1000)
y2 = dnorm(x2, m, s/sqrt(4))
lines(x2, y2, lty=2, lwd=2, col='blue')
hist(t16.mean, prob=T, main='표본크기: 16', ylab='', xlab='',
col='orange', border='red')
x3 = seq(min(t16.mean), max(t16.mean), length=1000)
y3 = dnorm(x3, m, s/sqrt(16))
lines(x3, y3, lty=2, lwd=2, col='blue')
hist(t32.mean, prob=T, main='표본크기: 32', ylab='', xlab='',
col='orange', border='red')
x4 = seq(min(t32.mean), max(t32.mean), length=1000)
y4 = dnorm(x4, m, s/sqrt(32))
lines(x4, y4, lty=2, lwd=2, col='blue')
### 카이제곱 분포(자유도=5)
chi2.mean = rep(NA, n)
chi4.mean = rep(NA, n)
chi16.mean = rep(NA, n)
chi32.mean = rep(NA, n)
for (i in 1:n) {
chi2.mean = mean(rchisq(2, df=df))
chi4.mean = mean(rchisq(4, df=df))
chi16.mean = mean(rchisq(16, df=df))
chi32.mean = mean(rchisq(32, df=df))
}
# 카이제곱 분포(자유도=5)의 평균과 표준편차
m = df
s = sqrt(2 * df)
par(mfrow=c(2,2), oma=c(0,0,2,0), family='malgun')
hist(chi2.mean, prob=T, main='표본크기: 2', ylab='', xlab='',
col='orange', border='red')
y1 = dnorm(x1, m, s/sqrt(2))
chi32.mean[i] = mean(rchisq(32, df=df))
# 카이제곱 분포(자유도=5)의 평균과 표준편차
m = df
s = sqrt(2 * df)
par(mfrow=c(2,2), oma=c(0,0,2,0), family='malgun')
hist(chi2.mean, prob=T, main='표본크기: 2', ylab='', xlab='',
col='orange', border='red')
x1 = seq(min(chi2.mean), max(chi2.mean), length=1000)
y1 = dnorm(x1, m, s/sqrt(2))
lines(x1, y1, lty=2, lwd=2, col='blue')
chi2.mean = rep(NA, n)
chi4.mean = rep(NA, n)
chi16.mean = rep(NA, n)
chi32.mean = rep(NA, n)
for (i in 1:n) {
chi2.mean[i] = mean(rchisq(2, df=df))
chi4.mean[i] = mean(rchisq(4, df=df))
chi16.mean[i] = mean(rchisq(16, df=df))
chi32.mean[i] = mean(rchisq(32, df=df))
}
# 카이제곱 분포(자유도=5)의 평균과 표준편차
m = df
s = sqrt(2 * df)
par(mfrow=c(2,2), oma=c(0,0,2,0), family='malgun')
hist(chi2.mean, prob=T, main='표본크기: 2', ylab='', xlab='',
col='orange', border='red')
x1 = seq(min(chi2.mean), max(chi2.mean), length=1000)
y1 = dnorm(x1, m, s/sqrt(2))
lines(x1, y1, lty=2, lwd=2, col='blue')
lines(x2, y2, lty=2, lwd=2, col='blue')
hist(chi4.mean, prob=T, main='표본크기: 4', ylab='', xlab='',
col='orange', border='red')
x2 = seq(min(chi4.mean), max(chi4.mean), length=1000)
y2 = dnorm(x2, m, s/sqrt(4))
lines(x2, y2, lty=2, lwd=2, col='blue')
hist(chi16.mean, prob=T, main='표본크기: 16', ylab='', xlab='',
col='orange', border='red')
x3 = seq(min(chi16.mean), max(chi16.mean), length=1000)
y3 = dnorm(x3, m, s/sqrt(16))
lines(x3, y3, lty=2, lwd=2, col='blue')
hist(chi32.mean, prob=T, main='표본크기: 32', ylab='', xlab='',
col='orange', border='red')
x4 = seq(min(chi32.mean), max(chi32.mean), length=1000)
y4 = dnorm(x4, m, s/sqrt(32))
lines(x4, y4, lty=2, lwd=2, col='blue')
mtext('카이제곱 표본평균의 분포(자유도=5)', outer=T, cex=1.2)
mtext('t 표본평균의 분포(자유도=5)', outer=T, cex=1.2)
### F-분포(자유도1=5, 자유도2=10)
f2.mean = rep(NA, n)
f4.mean = rep(NA, n)
f16.mean = rep(NA, n)
f32.mean = rep(NA, n)
for (i in 1:n) {
f2.mean[i] = mean(rf(2, df1=df, df2=df2))
f4.mean[i] = mean(rf(4, df1=df, df2=df2))
f16.mean[i] = mean(rf(16, df1=df, df2=df2))
f32.mean[i] = mean(rf(32, df1=df, df2=df2))
}
# F 분포(자유도1=5, 자유도2=10)의 평균과 표준편차
m = df2 / (df2 - 2)
m = df2 / (df2 - 2)
s = sqrt((2*df2^2*(df+df2-2)) / (df*(df2-2)^2*(df2-4)))
par(mfrow=c(2,2), oma=c(0,0,2,0), family='malgun')
hist(f2.mean, prob=T, main='표본크기: 2', ylab='', xlab='',
col='orange', border='red')
x1 = seq(min(f2.mean), max(f2.mean), length=1000)
y1 = dnorm(x1, m, s/sqrt(2))
lines(x1, y1, lty=2, lwd=2, col='blue')
hist(f4.mean, prob=T, main='표본크기: 4', ylab='', xlab='',
col='orange', border='red')
x2 = seq(min(f4.mean), max(f4.mean), length=1000)
y2 = dnorm(x2, m, s/sqrt(4))
lines(x2, y2, lty=2, lwd=2, col='blue')
hist(f16.mean, prob=T, main='표본크기: 16', ylab='', xlab='',
col='orange', border='red')
x3 = seq(min(f16.mean), max(f16.mean), length=1000)
y3 = dnorm(x3, m, s/sqrt(16))
lines(x3, y3, lty=2, lwd=2, col='blue')
hist(f32.mean, prob=T, main='표본크기: 32', ylab='', xlab='',
col='orange', border='red')
x4 = seq(min(f32.mean), max(f32.mean), length=1000)
y4 = dnorm(x4, m, s/sqrt(32))
lines(x4, y4, lty=2, lwd=2, col='blue')
par(mfrow=c(1,1))
f2.mean = rep(NA, n)
f4.mean = rep(NA, n)
f16.mean = rep(NA, n)
f32.mean = rep(NA, n)
for (i in 1:n) {
f2.mean[i] = mean(rf(2, df1=df, df2=df2))
f4.mean[i] = mean(rf(4, df1=df, df2=df2))
f16.mean[i] = mean(rf(16, df1=df, df2=df2))
f32.mean[i] = mean(rf(32, df1=df, df2=df2))
}
# F 분포(자유도1=5, 자유도2=10)의 평균과 표준편차
m = df2 / (df2 - 2)
s = sqrt((2*df2^2*(df+df2-2)) / (df*(df2-2)^2*(df2-4)))
par(mfrow=c(2,2), oma=c(0,0,2,0), family='malgun')
hist(f2.mean, prob=T, main='표본크기: 2', ylab='', xlab='',
col='orange', border='red')
x1 = seq(min(f2.mean), max(f2.mean), length=1000)
y1 = dnorm(x1, m, s/sqrt(2))
lines(x1, y1, lty=2, lwd=2, col='blue')
hist(f4.mean, prob=T, main='표본크기: 4', ylab='', xlab='',
col='orange', border='red')
x2 = seq(min(f4.mean), max(f4.mean), length=1000)
y2 = dnorm(x2, m, s/sqrt(4))
lines(x2, y2, lty=2, lwd=2, col='blue')
hist(f16.mean, prob=T, main='표본크기: 16', ylab='', xlab='',
col='orange', border='red')
x3 = seq(min(f16.mean), max(f16.mean), length=1000)
y3 = dnorm(x3, m, s/sqrt(16))
lines(x3, y3, lty=2, lwd=2, col='blue')
hist(f32.mean, prob=T, main='표본크기: 32', ylab='', xlab='',
col='orange', border='red')
x4 = seq(min(f32.mean), max(f32.mean), length=1000)
y4 = dnorm(x4, m, s/sqrt(32))
lines(x4, y4, lty=2, lwd=2, col='blue')
mtext('F 표본평균의 분포(자유도=5)', outer=T, cex=1.2)
par(mfrow=c(1,1))
### 단일 모집단의 평균 검정(1-sample T test)
df = read.table('data/babyboom.dat.txt', header=F)
names(df) = c('time','gender','weight','minutes')
head(df)
girl_baby = subset(df, gender==1)    # df[df$gender==1,]
weight = girl_baby[[3]]
weigh
weight
barx = mean(weight)
s = sd(weight)
n = length(weight)
mu0 = 2800
t = (barx - mu0) / (s / sqrt(n))
t
# 임계값과 유의확률
alpha = 0.05
uppper.limit = qt(1 - alpha, df=n-1)
upper.limit = qt(1 - alpha, df=n-1)
upper.limit
# 판정
if (t > upper.limit) {
print('귀무가설 기각')
print('여자 신생아의 체중이 2800보다 크다.')
} else {
print('귀무가설 채택')
print('여자 신생아의 체중이 2800보다 크지 않다.')
}
p.value = 1 - pt(t, df=n-1)
p.value
# 판정
if (p.value < alpha) {
print('귀무가설 기각')
print('여자 신생아의 체중이 2800보다 크다.')
} else {
print('귀무가설 채택')
print('여자 신생아의 체중이 2800보다 크지 않다.')
}
# R
t.test(weight, mu=2800, alternative='greater')
####################################################################
# 정규성 검정 - 표본이 정규성을 가져야 1-sample T test를 할 수 있음.
####################################################################
shapiro.test(weights)
####################################################################
# 정규성 검정 - 표본이 정규성을 가져야 1-sample T test를 할 수 있음.
####################################################################
shapiro.test(weight)
qqnorm(weight)
qqline(weight)
shapiro.test(x)
x = c(25, 16, 44, 82, 36, 58, 18)
shapiro.test(x)
qqnorm(x)
qqline(x)
qqline(x, col='red')
x = c(25, 16, 44, 82, 36, 58, 63, 18)
shapiro.test(x)     # p-value: 0.5
qqnorm(x)
qqline(x, col='red')
### 단일 모비율의 검정
bb = read.table('data/restitution.txt', header=F)
head(bb)
### 단일 모비율의 검정
bb = read.table('data/restitution.txt')
head(bb)
### 단일 모비율의 검정
bb = read.table('data/restitution.txt', header=T
### 단일 모비율의 검정
bb = read.table('data/restitution.txt', header=T)
head(bb)
bb = read.table('data/restitution.txt', header=T)
head(bb)
rel = ifelse(bb$rst < 0.4134 | bb$rst > 0.4374, 1, 0)
# 검정 통계량 계산
n = length(rel)
nos = sum(rel)
nos
z = (phat - p0) / sqrt(p0 * (1-p0) / n)
phat = nos / n
p0 = 0.1
z = (phat - p0) / sqrt(p0 * (1-p0) / n)
# 임계값과 유의확률
alpha = 0.05
uppper.limit = qnorm(1 - alpha)
p.value = 1 - pnorm(z)
c(uppper.limit, p.value)
# R: prop.test
prop.test(nos, n, p=0.1, alternative='greater', correct=F)
par(mar=c(0,1,1,1))
x <- seq(-3, 3, by=0.001)
y <- dnorm(x)
plot(x, y, type="l", axes=F, ylim=c(-0.02, 0.4),
main="", xlab="z", ylab="")
abline(h=0)
polygon(c(upper.limit, x[x>upper.limit], 3), c(0, y[x>upper.limit], 0), col=2)
text(upper.limit, -0.02, expression(z[0.05]==1.645))
polygon(c(z, x[x>z], 3), c(0, y[x>z], 0), density=20, angle=45)
text(z, -0.02, paste("z=", round(z, 3)))
text(1.2, 0.3, paste("P(Z>z)=", round(p.value, 3)), cex=0.8)
### 독립 표본: 2 sample T test
data = read.table('data/chapter7.txt', header=T)
head(data)
data = read.table('data/chapter7.txt', header=T)
head(data)
##### 모집단이 2개인 경우의 평균 비교 검정
### 독립 표본: 2 sample T test
data = read.table('data/chapter7.txt', header=T)
head(data)
girl = subset(data, gender==1)
boy = subset(data, gender==2)
# 등분산성 테스트
var.test(data$weight ~ data$gender)
# 2-sample T test
t.test(data$weight ~ data$gender, mu=0, alternative='less', var.equal=T)
c(mean(girl$weight), mean(boy$weight))
# 정규성 테스트
shapiro.test(girl$weight)
shapiro.test(boy$weight)   # p-value = 0.02
qqnorm(boy$weight)
qqline(boy$weight)
### 대응 표본: paired T test
# 식욕부진 치료요법의 효과 검증
data = read.csv('data/anorexia.csv')
head(data)
t.test(data$Prior, data$Post, paired=T, alternative='less')
n = 10
p = 4/5
dbinom(7, n, p)
# 3. A라는 회사는 스마트폰의 한 부품을 만드는 회사로, 이 A사의 불량률은 5%로 알려져 있다.
#    이 회사의 제품 20개를 조사했을 때, 불량이 2개 이하로 나올 확률을 구하시오.
n = 20
p = 0.05
pbinom(2, n, p)
# 4. 어떤 희귀 바이러스에 감염되었을 때, 회복할 수 있는 치료율은 20%라고 한다. 이
#    바이러스에 감염된 환자 20명을 치료했을 때, 적어도 2명 이상은 회복될 확률을 구하시오.
n = 20
p = 0.2
1 - pbinom(1, n, p)
pbinom(1, n, p)
pbinom(2, n, p)
pbinom(3, n, p)
pbinom(4, n, p)
# 1. A라는 전구회사에서 생산하는 전구의 수명은 800일이고 표준편차는 40일인 정규분포를
#    따른다고 한다. 이때 전구의 수명이 750일 이하일 확률을 구하시오.
prob = round(pnorm(750, 800, 40), 4)
# 1. A라는 전구회사에서 생산하는 전구의 수명은 800일이고 표준편차는 40일인 정규분포를
#    따른다고 한다. 이때 전구의 수명이 750일 이하일 확률을 구하시오.
round(pnorm(750, 800, 40), 4)
# 2. 한 축구 선수가 페널티킥을 차면 5번 중 4번을 성공한다고 한다.
#    이 선수가 10번의 페널티킥을 차서 7번 성공할 확률을 구하시오.
dbinom(7, 10, 4/5)     # 0.2013266
# 3. A라는 회사는 스마트폰의 한 부품을 만드는 회사로, 이 A사의 불량률은 5%로 알려져 있다.
#    이 회사의 제품 20개를 조사했을 때, 불량이 2개 이하로 나올 확률을 구하시오.
pbinom(2, 20, 0.05)     # 0.9245163
# 4. 어떤 희귀 바이러스에 감염되었을 때, 회복할 수 있는 치료율은 20%라고 한다. 이
#    바이러스에 감염된 환자 20명을 치료했을 때, 적어도 2명 이상은 회복될 확률을 구하시오.
1 - pbinom(1, 20, 0.2)     # 0.9308247
# 1. A라는 전구회사에서 생산하는 전구의 수명은 800일이고 표준편차는 40일인 정규분포를
#    따른다고 한다. 이때 전구의 수명이 750일 이하일 확률을 구하시오.
round(pnorm(750, 800, 40), 4)
# 2. 어느 한 회사에 다니는 종업원들의 근무기간을 조사하였더니, 평균은 11년이고 분산이
#    16년인 정규분포를 따른다고 한다.
#    1) 20년 이상 근무한 종업원의 비율을 구하시오.
#    2) 근무연수가 가장 오래된 10%의 종업원은 이 회사에서 몇 년 이상 근무했다고 볼 수 있는가?
1 - round(pnorm(20, 11, 16), 4)
round(qnorm(0.1, 11, 6), 4)
round(qnorm(0.9, 11, 6), 4)
round(qnorm(0.9, 11, 16), 4)         #
# 3. 어느 고등학교 3학년 학생들의 수학성적은 평균이 70이고 표준편차가 8인 정규분포를
#    따른다고 한다. 이때 점수가 80점 이상이고 90점 이하인 학생의 비율을 구하시오.
1 - pnorm(80, 70, 8)
# 3. 어느 고등학교 3학년 학생들의 수학성적은 평균이 70이고 표준편차가 8인 정규분포를
#    따른다고 한다. 이때 점수가 80점 이상이고 90점 이하인 학생의 비율을 구하시오.
pnorm(90, 70, 8) - pnorm(80, 70, 8)
# 4. 확률변수 X가 평균이 1.5, 표준편차가 2인 정규분포를 따를 때, 실수 전체의 집합에서
#    정의된 함수 H(t)는 H(t) = P(t ≤ X ≤ t+1) 이다. H(0) + H(2)의 값을 구하시오.
pnorm(3, 1.5, 2)
# 1. A라는 전구회사에서 생산하는 전구의 수명은 800일이고 표준편차는 40일인 정규분포를
#    따른다고 한다. 이때 전구의 수명이 750일 이하일 확률을 구하시오.
pnorm(750, 800, 40)   # 0.1056
# 2. 어느 한 회사에 다니는 종업원들의 근무기간을 조사하였더니, 평균은 11년이고 분산이
#    16년인 정규분포를 따른다고 한다.
#    1) 20년 이상 근무한 종업원의 비율을 구하시오.
#    2) 근무연수가 가장 오래된 10%의 종업원은 이 회사에서 몇 년 이상 근무했다고 볼 수 있는가?
1 - pnorm(20, 11, 16)     # 0.2869
qnorm(0.9, 11, 16)        # 31.5048
t.test(smp, mu=1000)
# 1. A회사의 건전지의 수명시간이 1000시간 일 때, 무작위로 뽑은 10개의 건전지에 대한 수명은 다음과 같다.
#    980, 1008, 968, 1032, 1012, 996, 1021, 1002, 996, 1017
#    샘플이 모집단과 같다고 할 수 있는가?
smp = c(980, 1008, 968, 1032, 1012, 996, 1021, 1002, 996, 1017)
t.test(smp, mu=1000)
t.test(smp, mu=55)
mean(smp)
# 2. 어떤 반의 학생들의 수학 평균성적은 55점이었다. 0교시 수업을 시행하고 나서 학생들의 시험 성적은 다음과 같다.
#    58, 49, 39, 99, 32, 88, 62, 30, 55, 65, 44, 55, 57, 53, 88, 42, 39
#    0교시 수업을 시행한 후, 학생들의 성적은 올랐다고 할 수 있는가?
smp1 = c(58, 49, 39, 99, 32, 88, 62, 30, 55, 65, 44, 55, 57, 53, 88, 42, 39)
t.test(smp1, mu=55)          # p-value < 2.2e-16
mean(smp1)
t.test(smp2, mu=8.1)
# 3. 2006년 조사에 의하면 한국인의 1인 1일 평균 알코올 섭취량이 8.1g 이다.
#    2008년 무작위로 뽑은 알코올 섭취량은 다음과 같다.
#    15.50, 11.21, 12.67, 8.87, 12.15, 9.88, 2.06, 14.50, 0, 4.97
#    평균 알코올 섭취량이 달라졌다고 할 수 있는가?
smp2 = c(15.50, 11.21, 12.67, 8.87, 12.15, 9.88, 2.06, 14.50, 0, 4.97)
t.test(smp2, mu=8.1)
mean(smp)
mean(smp2)              #
# 1. mtcars 데이터셋에서 자동차 기어 종류(am: 오토/수동)에 따른 mpg의 차이가
#    통계적으로 유의한지 t-test를 통해 확인해 보시오.
data("mtcars")
# 1. mtcars 데이터셋에서 자동차 기어 종류(am: 오토/수동)에 따른 mpg의 차이가
#    통계적으로 유의한지 t-test를 통해 확인해 보시오.
data('mtcars')
mtcars
t.test(mtcars$am ~ mtcars$mpg, mu=0)
t.test(mtcars$am ~ mtcars$mpg, mu=0, alternative='less', var.equal=T)
var.test(mtcars$am ~ mtcars$mpg)
# 1. mtcars 데이터셋에서 자동차 기어 종류(am: 오토/수동)에 따른 mpg의 차이가
#    통계적으로 유의한지 t-test를 통해 확인해 보시오.
data('mtcars')
mtcars
var.test(mtcars$am ~ mtcars$mpg)
a = subset(mtcars, am==1)
b = subset(mtcars, am==0)
c(mean(mtcars$am), mean(mtcars$mpg))
c(mean(a$mpg), mean(b$mpg))
var.test(mtcars$am ~ mtcars$mpg)
var.test(mtcars$mpg ~ mtcars$am)
#a = subset(mtcars, am==1)
#b = subset(mtcars, am==0)
#c(mean(a$mpg), mean(b$mpg))
#var.test(mtcars$mpg ~ mtcars$am)
t.test(mtcars$mpg ~ mtcars$am, mu=0, alternative='less', var.equal=T)
#a = subset(mtcars, am==1)
#b = subset(mtcars, am==0)
#c(mean(a$mpg), mean(b$mpg))
#var.test(mtcars$mpg ~ mtcars$am)
t.test(mtcars$mpg ~ mtcars$am, mu=0)
# 2. MASS 패키지에 내장된 Cars93 데이터프레임에 대해서 생산국(Origin)이
#    USA vs. non-USA 2개의 group 에 대해서 차 가격(Price)의 평균이 차이가 있는지를 검정해보시오.
data('Cars93')
# 2. MASS 패키지에 내장된 Cars93 데이터프레임에 대해서 생산국(Origin)이
#    USA vs. non-USA 2개의 group 에 대해서 차 가격(Price)의 평균이 차이가 있는지를 검정해보시오.
data('Cars93', package='MASS')
Cars93
t.test(Cars93$Price ~ Cars93$Origin, mu=0)
# 3. mpg 데이터셋에서 다음을 검정해 보시오.
#    1) subcompact 자동차와 midsize 자동차의 고속도로 연비
#    2) 일반 휘발유(r)와 고급 휘발유(p)의 도시 연비
#    3) subcompact 자동차의 전륜구동(f)이냐 후륜구동(r)이냐에 따른 도시 연비
data('mpg')
# 3. mpg 데이터셋에서 다음을 검정해 보시오.
#    1) subcompact 자동차와 midsize 자동차의 고속도로 연비
#    2) 일반 휘발유(r)와 고급 휘발유(p)의 도시 연비
#    3) subcompact 자동차의 전륜구동(f)이냐 후륜구동(r)이냐에 따른 도시 연비
data('mpg', package='stats')
# 3. mpg 데이터셋에서 다음을 검정해 보시오.
#    1) subcompact 자동차와 midsize 자동차의 고속도로 연비
#    2) 일반 휘발유(r)와 고급 휘발유(p)의 도시 연비
#    3) subcompact 자동차의 전륜구동(f)이냐 후륜구동(r)이냐에 따른 도시 연비
library('ggplot2')
mpg = ggplot2::mpg
mpg
)
)
mpg = data.frame(mpg)
mpg
# 2. 어느 한 회사에 다니는 종업원들의 근무기간을 조사하였더니, 평균은 11년이고 분산이
#    16년인 정규분포를 따른다고 한다.
#    1) 20년 이상 근무한 종업원의 비율을 구하시오.
#    2) 근무연수가 가장 오래된 10%의 종업원은 이 회사에서 몇 년 이상 근무했다고 볼 수 있는가?
1 - pnorm(20, 11, 4)     # 0.2868877
qnorm(0.9, 11, 4)        # 31.50483
# 2. 어떤 반의 학생들의 수학 평균성적은 55점이었다. 0교시 수업을 시행하고 나서 학생들의 시험 성적은 다음과 같다.
#    58, 49, 39, 99, 32, 88, 62, 30, 55, 65, 44, 55, 57, 53, 88, 42, 39
#    0교시 수업을 시행한 후, 학생들의 성적은 올랐다고 할 수 있는가?
smp1 = c(58, 49, 39, 99, 32, 88, 62, 30, 55, 65, 44, 55, 57, 53, 88, 42, 39)
t.test(smp1, mu=55, alternative='greater')     # p-value = 0.8092
# 1. A회사의 건전지의 수명시간이 1000시간 일 때, 무작위로 뽑은 10개의 건전지에 대한 수명은 다음과 같다.
#    980, 1008, 968, 1032, 1012, 996, 1021, 1002, 996, 1017
#    샘플이 모집단과 같다고 할 수 있는가?
smp = c(980, 1008, 968, 1032, 1012, 996, 1021, 1002, 996, 1017)
shapiro.test(smp)
shapiro.test(smp)
shapiro.test(smp1)
# 3. 2006년 조사에 의하면 한국인의 1인 1일 평균 알코올 섭취량이 8.1g 이다.
#    2008년 무작위로 뽑은 알코올 섭취량은 다음과 같다.
#    15.50, 11.21, 12.67, 8.87, 12.15, 9.88, 2.06, 14.50, 0, 4.97
#    평균 알코올 섭취량이 달라졌다고 할 수 있는가?
smp2 = c(15.50, 11.21, 12.67, 8.87, 12.15, 9.88, 2.06, 14.50, 0, 4.97)
shapiro.test(smp3)
# 3. 2006년 조사에 의하면 한국인의 1인 1일 평균 알코올 섭취량이 8.1g 이다.
#    2008년 무작위로 뽑은 알코올 섭취량은 다음과 같다.
#    15.50, 11.21, 12.67, 8.87, 12.15, 9.88, 2.06, 14.50, 0, 4.97
#    평균 알코올 섭취량이 달라졌다고 할 수 있는가?
smp2 = c(15.50, 11.21, 12.67, 8.87, 12.15, 9.88, 2.06, 14.50, 0, 4.97)
shapiro.test(smp2)
# 1. mtcars 데이터셋에서 자동차 기어 종류(am: 오토/수동)에 따른 mpg의 차이가
#    통계적으로 유의한지 t-test를 통해 확인해 보시오.
data('mtcars')
mtcars
table(mtcars$am)
# 3. mpg 데이터셋에서 다음을 검정해 보시오.
#    1) subcompact 자동차와 midsize 자동차의 고속도로 연비
#    2) 일반 휘발유(r)와 고급 휘발유(p)의 도시 연비
#    3) subcompact 자동차의 전륜구동(f)이냐 후륜구동(r)이냐에 따른 도시 연비
data('mpg', package='ggplot2')
mpg
# 2. MASS 패키지에 내장된 Cars93 데이터프레임에 대해서 생산국(Origin)이
#    USA vs. non-USA 2개의 group 에 대해서 차 가격(Price)의 평균이 차이가 있는지를 검정해보시오.
data('Cars93', package='MASS')
Cars93
table(Cars93$Origin)
# 3. mpg 데이터셋에서 다음을 검정해 보시오.
#    1) subcompact 자동차와 midsize 자동차의 고속도로 연비
#    2) 일반 휘발유(r)와 고급 휘발유(p)의 도시 연비
#    3) subcompact 자동차의 전륜구동(f)이냐 후륜구동(r)이냐에 따른 도시 연비
data('mpg', package='ggplot2')
mpg
talbe(mpg$class)
table(mpg$class)
t.test(subcompact$hwy ~ midsize$hwy, mu=0)
subcompact = mpg[mpg$class == 'subcompact',]
midsize = mpg[mpg$class == 'midsize',]
t.test(subcompact$hwy ~ midsize$hwy, mu=0)
t.test(subcompact$hwy, midsize$hwy)
table(mpg$fl)
r = mpg[mpg$fl == 'r',]
p = mpg[mpg$fl == 'p',]
t.test(r$cty, p$cty)
shapiro.test(mtcars$mpg[mtacars$am == 0])
shapiro.test(mtcars$mpg[mtacars$am == 1])
# 1. mtcars 데이터셋에서 자동차 기어 종류(am: 오토/수동)에 따른 mpg의 차이가
#    통계적으로 유의한지 t-test를 통해 확인해 보시오.
data('mtcars')
# 1. mtcars 데이터셋에서 자동차 기어 종류(am: 오토/수동)에 따른 mpg의 차이가
#    통계적으로 유의한지 t-test를 통해 확인해 보시오.
data('mtcars')
mtcars
table(mtcars$am)    # 0(수동)-19, 1(자동)-13
shapiro.test(mtcars$mpg[mtacars$am == 0])
